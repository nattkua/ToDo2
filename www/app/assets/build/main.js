!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var s=i(1),r=n(s);new r["default"]},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=i(2),l=i(3),d=n(l),u=i(5),c=n(u),h=i(6),v=n(h),f=function(){function e(){var t=this;r(this,e),this.state=new d["default"],this.todos=[],this.activeTodos=[],this.displayUpcoming=!0,this.panel=new v["default"],this.panel.submitTodo=this.panelSubmitAction.bind(this),this.listEL=document.querySelector("#todo-list"),this.toggleListBTN=document.querySelector("[data-toggle-list]"),this.newTodoBTN=document.querySelector("[data-new-todo]"),this.delay=100,this.color=a.pickColor(),this.state.on("All Todos",this.allTodos.bind(this)),this.state.on("Updated Todo",function(e){return t.updateTodo(e)}),this.state.on("New Todo",function(e){return t.newTodo(e)}),this.state.on("Completed Todo",function(e){return t.completedTodo(e)}),this.state.on("Delete Todo",function(e){return t.deleteTodo(e)}),this.toggleListBTN.addEventListener("click",this.toggleList.bind(this)),this.newTodoBTN.addEventListener("click",function(){t.displayUpcoming||t.toggleList(),t.panel.open()}),this.state.get()}return o(e,[{key:"allTodos",value:function(e){this.todos=e,this.createList()}},{key:"toggleList",value:function(){var e=this,t=new Promise(function(t){setTimeout(t,e.delay*e.activeTodos.length)});this.color=a.pickColor(),this.displayUpcoming=!this.displayUpcoming,this.toggleListBTN.innerHTML=this.displayUpcoming?"Completed Todos":"Upcoming Todos",this.clearList(),t.then(this.createList.bind(this))}},{key:"createList",value:function(){var e=this,t=this.todos.filter(function(t){return t.completed!=e.displayUpcoming});t.map(function(t){return e.initTodo(t)})}},{key:"clearList",value:function(){var e=this;this.activeTodos.reverse().map(function(t){return e.removeTodo(t)})}},{key:"sortList",value:function(){var e=this;this.activeTodos.sort(function(e,t){return new Date(t.dueDate)-new Date(e.dueDate)}),this.activeTodos.map(function(t){return e.listEL.removeChild(t.div)}),this.activeTodos.map(function(t){return e.listEL.insertBefore(t.div,e.listEL.firstChild)})}},{key:"initTodo",value:function(e){var t=new c["default"](e);t.primaryAction=this.todoPrimaryAction.bind(this),t.edit=this.todoEditAction.bind(this),t["delete"]=this.todoDeleteAction.bind(this),this.activeTodos=[].concat(s(this.activeTodos),[t]),t.rendered||this.addTodo(t)}},{key:"addTodo",value:function(e){var t=this.delay*this.activeTodos.indexOf(e),i=a.colorDarken(this.color,-(this.activeTodos.indexOf(e)/50));e.div.setAttribute("style",["color: "+i]),this.listEL.insertBefore(e.div,this.listEL.firstChild),e["in"](t),e.rendered=!0}},{key:"removeTodo",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.delay*this.activeTodos.length;e.out(i),setTimeout(function(){t.listEL.removeChild(e.div)},i+300),e.rendered=!1,this.activeTodos=this.activeTodos.filter(function(t){return e.id!=t.id})}},{key:"updateTodo",value:function(e){var t=this.activeTodos.find(function(t){return t.id==e.id}),i=this.todos.find(function(t){return t.id==e.id});t.title=e.title,t.dueDate=e.due_date,i.title=e.title,i.dueDate=e.due_date,t.refresh(),this.sortList()}},{key:"newTodo",value:function(e){this.todos.push(e),this.initTodo(e),this.sortList()}},{key:"completedTodo",value:function(e){var t=this.activeTodos.find(function(t){return t.id==e.id}),i=this.todos.find(function(t){return t.id==e.id});t.completed=!t.completed,i.completed=!i.completed,this.removeTodo(t,this.delay)}},{key:"deleteTodo",value:function(e){var t=this.activeTodos.find(function(t){return t.id==e});this.todos=this.todos.filter(function(t){return t.id!=e}),this.removeTodo(t,this.delay)}},{key:"todoPrimaryAction",value:function(e){var t={id:e.id,title:e.title,due_date:a.dbDate(e.dueDate),completed:!e.completed};this.state.post("Completed Todo",t)}},{key:"todoEditAction",value:function(e){this.panel.open(null,e.title,e.dueDate,e.id)}},{key:"todoDeleteAction",value:function(e){var t={id:e.id,title:e.title,due_date:e.dueDate,completed:!e.completed};this.state["delete"]("Delete Todo",t)}},{key:"panelSubmitAction",value:function(e){var t=""==e.id?"New Todo":"Updated Todo",i=""==e.id?null:e.id,n={id:i,title:e.title,due_date:e.due_date,completed:e.completed};this.state.post(t,n)}}]),e}();t["default"]=f},function(e,t){"use strict";function i(e){var t=new Date(e),i=t.getFullYear(),n=t.getDate(),s=t.getMonth()+1;return 10>n&&(n="0"+n),10>s&&(s="0"+s),i+"-"+s+"-"+n}function n(e){return e}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,i=new Date(e),n=new Date(t);return i.setHours(0,0,0,0),n.setHours(0,0,0,0),n>i?!0:!1}function r(e,t){var i=e.split(","),n=0>t?0:255,s=0>t?-1*t:t,r=parseInt(i[0].slice(4)),o=parseInt(i[1]),a=parseInt(i[2]);return"rgb("+(Math.round((n-r)*s)+r)+","+(Math.round((n-o)*s)+o)+","+(Math.round((n-a)*s)+a)+")"}function o(){var e=["rgb(0,117,217)","rgb(0,137,87)","rgb(220, 0, 173)","rgb(177, 13, 201)"];return e[Math.floor(Math.random()*e.length)]}Object.defineProperty(t,"__esModule",{value:!0}),t.dbDate=i,t.viewDate=n,t.dateCompair=s,t.colorDarken=r,t.pickColor=o},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(4),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.EventEmitter;n(this,e),this.ee=t}return s(e,[{key:"on",value:function(e,t){this.ee.on(e,t)}},{key:"get",value:function(){var e={method:"GET"};this.request("All Todos",e)}},{key:"post",value:function(e,t){var i=new FormData;for(var n in t)i.append(n,t[n]);var s={method:"POST",body:i};this.request(e,s)}},{key:"delete",value:function(e,t){var i={method:"DELETE",body:JSON.stringify(t)};this.request(e,i)}},{key:"request",value:function t(e,i){var n=this,t=new Request("/api/",i);fetch(t).then(function(e){return e.json()}).then(function(t){n.ee.emit(e,t)})}}]),e}();t["default"]=o},function(e){function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function n(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function r(e){return void 0===e}e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if(!n(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},t.prototype.emit=function(e){var t,n,o,a,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(n=this._events[e],r(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(s(n))for(a=Array.prototype.slice.call(arguments,1),d=n.slice(),o=d.length,l=0;o>l;l++)d[l].apply(this,a);return!0},t.prototype.addListener=function(e,n){var o;if(!i(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(n.listener)?n.listener:n),this._events[e]?s(this._events[e])?this._events[e].push(n):this._events[e]=[this._events[e],n]:this._events[e]=n,s(this._events[e])&&!this._events[e].warned&&(o=r(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},t.prototype.removeListener=function(e,t){var n,r,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},t.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},t.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},t.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(2),o=function(){function e(t){n(this,e),this.rendered=!1,this.id=t.id,this.title=t.title,this.dueDate=t.due_date,this.overdue=r.dateCompair(t.due_date),this.completed=t.completed,this.primaryAction=null,this["delete"]=null,this.edit=null,this.div=null,this.color="B10DC9",this.deleteBTN=null,this.editBTN=null,this.primaryBTN=null,this.build(),this.events()}return s(e,[{key:"events",value:function(){var e=this;this.primaryBTN.addEventListener("click",function(){e.primaryAction(e)}),this.completed===!1&&(this.deleteBTN.addEventListener("click",function(){e["delete"](e)}),this.editBTN.addEventListener("click",function(){e.edit(e)}))}},{key:"in",value:function(e){var t=this;setTimeout(function(){requestAnimationFrame(function(){t.div.classList.remove("js-todo-in")})},e)}},{key:"out",value:function(e){var t=this;setTimeout(function(){requestAnimationFrame(function(){t.div.classList.add("js-todo-out")})},e)}},{key:"refresh",value:function(){this.div.querySelector("h3.todo-info__title").innerHTML=this.title,this.div.querySelector("h2.todo-info__title span.text").innerHTML=this.dueDate,this.isOverdue()}},{key:"isOverdue",value:function(){r.dateCompair(this.dueDate)?this.div.querySelector(".message").classList.add("active"):this.div.querySelector(".message").classList.remove("active")}},{key:"build",value:function(){var e=this,t=this.color;e.div=document.createElement("div"),e.div.setAttribute("style",["color: #"+t]),e.div.className=e.completed===!1?"todo js-todo-in":"todo completed js-todo-in",e.div.id=e.id,e.div.tabIndex=0;var i=document.createElement("div");i.className=e.overdue===!0&&e.completed===!1?"message message--urgent active":"message message--urgent";var n=document.createElement("p");n.innerHTML="This ToDo is OverDo!";var s=document.createElement("div");s.className="todo-info";var r=document.createElement("div");r.className="todo-button-group button-group";var o=document.createElement("div");o.className="todo-primary-action";var a=document.createElement("h2");a.innerHTML='Due: <span class="text">'+e.dueDate+"</span>",a.className="todo-info__title";var l=document.createElement("h3");l.innerHTML=e.title,l.className="todo-info__title",e.completed===!1?(e.primaryBTN=document.createElement("button"),e.primaryBTN.innerHTML="Done",e.primaryBTN.className="button button--primary button--large js-todo-complete",e.editBTN=document.createElement("button"),e.editBTN.innerHTML="Edit",e.editBTN.className="button button--secondary js-todo-edit",e.deleteBTN=document.createElement("button"),e.deleteBTN.innerHTML="Delete",e.deleteBTN.className="button button--secondary js-todo-delete",r.appendChild(e.editBTN),r.appendChild(e.deleteBTN),o.appendChild(e.primaryBTN)):(e.primaryBTN=document.createElement("button"),e.primaryBTN.innerHTML="Undo",e.primaryBTN.className="button button--primary button--large js-todo-undo ",o.appendChild(e.primaryBTN)),i.appendChild(n),s.appendChild(a),s.appendChild(l),s.appendChild(r),e.div.appendChild(i),e.div.appendChild(s),e.div.appendChild(o)}}]),e}();t["default"]=o},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(2),o=function(){function e(){var t=this;n(this,e),this.active=!1,this.submitTodo,this.panelEL=document.querySelector(".todo-panel"),this.form=this.panelEL.querySelector("#todo-panel-form"),this.idINPUT=this.form.querySelector("[name=id]"),this.titleINPUT=this.form.querySelector("[name=title]"),this.dateGROUP=this.form.querySelector("[name=title]"),this.dINPUT=this.form.querySelector("[name=day]"),this.mINPUT=this.form.querySelector("[name=month]"),this.yINPUT=this.form.querySelector("[name=year]"),this.addBTN=this.form.querySelector("[data-panel-submit]"),this.cancelBTN=this.form.querySelector("[data-panel-cancel]"),this.err=this.form.querySelectorAll(".message"),this.addBTN.addEventListener("click",function(e){e.preventDefault(),t.prepTodo()}),this.cancelBTN.addEventListener("click",function(e){e.preventDefault(),t.close()}),this.titleINPUT.addEventListener("blur",function(){t.validateTitle()}),this.yINPUT.addEventListener("change",function(){t.validateDate()}),this.dINPUT.addEventListener("change",function(){t.validateDate()}),this.mINPUT.addEventListener("change",function(){t.validateDate()})}return s(e,[{key:"open",value:function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.idINPUT.value=i,this.titleINPUT.value=e,this.setDate(t),this.active=!0,this.panelEL.classList.add("active"),this.panelEL.setAttribute("aria-hidden",!1),this.titleINPUT.focus(),this.addBTN.innerHTML=null==i?"Add":"Edit"}},{key:"close",value:function(){this.active=!1,this.panelEL.classList.remove("active"),this.panelEL.setAttribute("aria-hidden",!0),this.form.reset(),this.resetErrors()}},{key:"setDate",value:function(e){e=new Date(e);var t=e.getFullYear(),i=e.getDate(),n=e.getMonth()+1;10>i&&(i="0"+i),10>n&&(n="0"+n),this.mINPUT.value=n,this.dINPUT.value=i,this.yINPUT.value=t}},{key:"validateTitle",value:function(){return""==this.titleINPUT.value?(this.titleINPUT.classList.add("error"),this.err[0].classList.add("active"),!1):(this.titleINPUT.classList.remove("error"),this.err[0].classList.remove("active"),!0)}},{key:"validateDate",value:function(){var e=r.dateCompair(this.mINPUT.value+"/"+this.dINPUT.value+"/"+this.yINPUT.value);return e?(this.dateGROUP.classList.add("error"),this.err[1].classList.add("active"),!1):(this.dateGROUP.classList.remove("error"),this.err[1].classList.remove("active"),!0)}},{key:"resetErrors",value:function(){this.titleINPUT.classList.remove("active"),this.dateGROUP.classList.remove("active"),this.err.forEach(function(e){return e.classList.remove("active")})}},{key:"prepTodo",value:function(){var e=this.yINPUT.value+"-"+this.mINPUT.value+"-"+this.dINPUT.value,t={id:this.idINPUT.value,title:this.titleINPUT.value,due_date:e,completed:!1};this.validateTitle()&&this.validateDate()&&(this.submitTodo(t),this.close())}}]),e}();t["default"]=o}]);